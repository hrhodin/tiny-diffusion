import numpy as np
import torch
from typing import Optional, Iterator, Dict

from sklearn.datasets import make_moons
from torch.utils.data import TensorDataset

import example_2Dsimple
import geometry


def moons_dataset(n=8000):
    X, _ = make_moons(n_samples=n, random_state=42, noise=0.03)
    X[:, 0] = (X[:, 0] + 0.3) * 2 - 1
    X[:, 1] = (X[:, 1] + 0.3) * 3 - 1
    return TensorDataset(torch.from_numpy(X.astype(np.float32)))